<form name="cascadeForm" ng-submit="save()" ng-controller="CascadeFormCtrl"  class="form-horizontal">
    <div class="col-lg-7">
        <div class="page-header"><h3>{{title}}<span ng-show="cascade.id"> ({{cascade.id}})</span></h3></div>

        <div class="form-group">
            <label class="col-lg-3" for="name">Name:</label>

            <div class="col-lg-9">
                <input class="form-control" ng-model="cascade.name" type="text" id="name" focus required>
            </div>
        </div>
        <div class="form-group">
            <label class="col-lg-3" for="recoType">RecoType:</label>

            <div class="col-lg-9">
                <select class="form-control" ng-model="cascade.recoType"
                        ng-options="t.name as t.name for t in recoTypes"
                        id="recoType"></select>
            </div>
        </div>

        <legend>Pipelines</legend>

        <div ng-controller="CascadePipelinesCtrl">
            <div class="row">
                <div class="col-md-2">
                    <button type="button" class="btn btn-default form-control" ng-click="addPipeline()"><i
                            class="fa fa-plus"></i>
                        Add
                    </button>
                </div>
            </div>

            <table class="table table-striped" ng-hide="cascade.pipelines.length == 0">
                <thead>
                <tr>
                    <th class="col-sm-1 text-center">Multiplier</th>
                    <th class="col-sm-1 text-center">Max</th>
                    <th class="col-sm-1 text-center">Burp as Optional</th>
                    <th class="col-sm-2 text-center">Apply only if previous SKUs exist</th>
                    <th class="col-sm-7 text-center">BurpId</th>
                    <th></th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="pipeline in cascade.pipelines">
                    <td><input class="form-control" ng-model="pipeline.multiplier"></td>
                    <td><input class="form-control" ng-model="pipeline.max"></td>
                    <td class="text-center"><input type="checkbox" ng-model="pipeline.burpAsOptional"></td>
                    <td class="text-center"><input type="checkbox" ng-model="pipeline.applyOnlyIfPreviousSkusExist">
                    </td>
                    <td>
                        <select class="form-control" ng-model="pipeline.burpId"
                                ng-options="t.id as t | configName for t in burps | filter:{recoType:cascade.recoType}">
                        </select>
                    </td>
                    <td>
                        <button type="button" class="btn btn-mini" ng-click="removePipeline($index)">Delete</button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <div class="text-right">
            <button class="btn btn-default" ng-click="cancel()">Cancel</button>
            <button class="btn btn-primary" ng-disabled="cascadeForm.$invalid">Save</button>
        </div>

    </div>
</form>
